<!DOCTYPE html>
<html>
  <head>
    <title>OC COVID-19 Metrics Dashboard</title>

    <!-- CSS Styling -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous">
    <link href="css/main.css" rel="stylesheet">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q3SYY6C1HE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-Q3SYY6C1HE');
    </script>
  </head>

  <body>
    <!-- Source: https://getbootstrap.com/docs/5.2/examples/headers/ -->
    <div class="container">
      <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
          <svg class="bi me-2" width="32" height="32" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2M12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2M12 22V12M12 2V12M12 12L17 17.5M12 12L17 7M12 12H19"
              stroke="white" stroke-linecap="round" stroke-linejoin="round" fill="darkorange"></path> </svg>
          <span class="fs-4">OC COVID-19 Metrics Dashboard</span>
        </a>
        <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
          <li>
            <a
              href="https://docs.google.com/spreadsheets/d/1M7BfyPuwHQiavFtH59sgI9lJ7HjBpjXdBB-5BWv15K4"
              class="nav-link px-2 link-dark"
              target="_blank">
                Data
             </a>
          </li>
          <li>
            <a
              href="https://github.com/klenwell/covid-19"
              class="nav-link px-2 link-dark"
              target="_blank">
                Code
             </a>
          </li>
          <li>
            <a
              href="https://old.reddit.com/r/CoronavirusOC/"
              class="nav-link px-2 link-dark"
              target="_blank">
                r/CoronavirusOC
             </a>
          </li>
        </ul>
      </header>

      <!--
        Nav tabs
        Source: https://getbootstrap.com/docs/5.0/components/navs-tabs/#javascript-behavior
      -->
      <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            id="pills-metrics-tab" data-bs-target="#metrics" aria-controls="metrics"
            class="nav-link active"  data-bs-toggle="pill"
            type="button" role="tab"  aria-selected="true">
            Metrics
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            id="pills-weekly-tab" data-bs-target="#weekly" aria-controls="weekly"
            class="nav-link"  data-bs-toggle="pill"
            type="button" role="tab"  aria-selected="true">
            Week-by-Week
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            id="pills-waves-tab" data-bs-target="#waves" aria-controls="waves"
            class="nav-link"  data-bs-toggle="pill"
            type="button" role="tab"  aria-selected="true">
            Waves
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            id="pills-phases-tab" data-bs-target="#phases" aria-controls="phases"
            class="nav-link"  data-bs-toggle="pill"
            type="button" role="tab"  aria-selected="true">
            Phases
          </button>
        </li>
      </ul>

      <!--
        Tab Content
      -->
      <div class="tab-content" id="pills-tabContent">
        <!--
          Metrics Tab View
        -->
        <div
          id="metrics" aria-labelledby="metrics-tab"
          class="tab-pane fade show active" role="tabpanel" >
          <section id="oc-covid-metrics">
            <h3>Latest Metrics</h3>
            <table class="table metrics">
              <caption></caption>
              <thead>
                <tr>
                  <th scope="col" class="capstone"></th>
                  <th scope="col">Metric</th>
                  <th scope="col">Updated</th>
                  <th scope="col">Latest</th>
                  <th scope="col">Level</th>
                  <th scope="col">Trend</th>
                  <th scope="col">7-Day Change</th>
                  <th scope="col">14-Day Change</th>
                </tr>
              </thead>
              <tbody>
                <tr class="rate" data-metric="positiveRate">
                  <th scope="row" class="capstone" rowspan="3">Less Lag &#129070;</th>
                  <th scope="row">
                    Test-Positive Rate
                    <span class="sub-th">7-day average</span>
                  </th>
                  <td class="updated-on">
                    <span class="value"></span>
                  </td>
                  <td class="latest">
                    <span class="value"></span>
                  </td>
                  <td class="level">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="trend">
                    <span class="value"></span>
                  </td>
                  <td class="delta-7d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="delta-14d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                </tr>
                <tr class="wastewater" data-metric="wastewater">
                  <th scope="row">
                    Wastewater Concentration
                    <span class="sub-th">7-day average (copies/ml)</span>
                  </th>
                  <td class="updated-on">
                    <span class="value"></span>
                  </td>
                  <td class="latest">
                    <span class="value"></span>
                  </td>
                  <td class="level">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="trend">
                    <span class="value"></span>
                  </td>
                  <td class="delta-7d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="delta-14d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                </tr>
                <tr class="cases" data-metric="cases">
                  <th scope="row">
                    Daily New Cases
                    <span class="sub-th">7-day average</span>
                  </th>
                  <td class="updated-on">
                    <span class="value"></span>
                  </td>
                  <td class="latest">
                    <span class="value"></span>
                  </td>
                  <td class="level">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="trend">
                    <span class="value"></span>
                  </td>
                  <td class="delta-7d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="delta-14d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                </tr>
                <tr class="hospitalizations" data-metric="hospitalCases">
                  <th class="capstone" scope="row" rowspan="3">&#129068; More Lag</th>
                  <th scope="row">
                    Hospitalizations
                    <span class="sub-th">7-day average</span>
                  </th>
                  <td class="updated-on">
                    <span class="value"></span>
                  </td>
                  <td class="latest">
                    <span class="value"></span>
                  </td>
                  <td class="level">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="trend">
                    <span class="value"></span>
                  </td>
                  <td class="delta-7d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="delta-14d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                </tr>
                <tr class="icus" data-metric="icuCases">
                  <th scope="row">
                    ICU Cases
                    <span class="sub-th">7-day average</span>
                  </th>
                  <td class="updated-on">
                    <span class="value"></span>
                  </td>
                  <td class="latest">
                    <span class="value"></span>
                  </td>
                  <td class="level">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="trend">
                    <span class="value"></span>
                  </td>
                  <td class="delta-7d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="delta-14d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                </tr>
                <tr class="deaths" data-metric="deaths">
                  <th scope="row">
                    Deaths
                    <span class="sub-th">7-day average</span>
                  </th>
                  <td class="updated-on">
                    <span class="value"></span>
                  </td>
                  <td class="latest">
                    <span class="value"></span>
                  </td>
                  <td class="level">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="trend">
                    <span class="value"></span>
                  </td>
                  <td class="delta-7d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                  <td class="delta-14d">
                    <span class="value"></span>
                    <span class="note"></span>
                  </td>
                </tr>
              </tbody>
            </table>

            <h4>Notes</h4>
            <ul>
              <li>
                Data extracted from JSON export:
                <a target="_blank" href="https://github.com/klenwell/covid-19/blob/master/docs/data/json/oc/metrics.json">docs/data/json/oc/metrics.json</a>.
                (File is updated as data becomes available.)
              </li>
              <li>
                Data sourced from
                <a target="_blank" href="https://occovid19.ochealthinfo.com/coronavirus-in-oc">OC Health Care Agency</a> and
                <a target="_blank" href="https://www.cdph.ca.gov/Programs/CID/DCDC/Pages/COVID-19/Wastewater-Surveillance.aspx">CA Dept of Public Health</a>.
              </li>
              <li>Table modeled after <a target="_blank" href="https://twitter.com/MicahPollak/status/1528887857670238212">Micah's Metric Matrix</a>.</li>
              <li>Level quartiles: low=0-25, moderate=25-50, high=50-75, very high=75-100</li>
              <li>Questions, comments, or issues? Email Tom at klenwell@gmail.com.</li>
            </ul>
          </section>
        </div>

        <!--
          Trends Tab View
        -->
        <div
          id="weekly" aria-labelledby="weekly-tab"
          class="tab-pane fade" role="tabpanel" >
          <section id="oc-covid-trends">
            <h3>Week-by-Week Trends</h3>
            <table class="table trends">
              <caption>Loading...</caption>
              <thead>
                <tr>
                  <th scope="col">Week</th>
                  <th scope="col">Test Positive Rate</th>
                  <th scope="col">
                    New Tests Admin'd
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">
                    Positive Tests
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">
                    Wastewater
                    <span class="sub-th">7-day average</span>
                    <span class="sub-th">(copies per milliliter)</span>
                  </th>
                  <th scope="col">
                    Hospital Cases
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">Deaths</th>
                  <th scope="col">End Date</th>
                  <th scope="col">Start Date</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>

            <h4>Notes</h4>
            <ul>
              <li>Test data for <strong>last week</strong> not yet fully reported.</li>
              <li>
                Data extracted from JSON export:
                <a target="_blank" href="https://github.com/klenwell/covid-19/blob/master/docs/data/json/oc/trends.json">
                  docs/data/json/oc/trends.json
                </a>.
              <li>
                Data sourced from
                <a target="_blank" href="https://occovid19.ochealthinfo.com/coronavirus-in-oc">OC Health Care Agency</a> and
                <a target="_blank" href="https://www.cdph.ca.gov/Programs/CID/DCDC/Pages/COVID-19/Wastewater-Surveillance.aspx">CA Dept of Public Health</a>.
              </li>
            </ul>
          </section>
        </div>

        <!--
          Waves Tab View
        -->
        <div
          id="waves" aria-labelledby="waves-tab"
          class="tab-pane fade" role="tabpanel">
          <section id="oc-covid-waves">
            <h3>COVID-19 Waves &bull; Orange County, CA</h3>

            <div class="chart-block">
              <canvas id="waves-chart"></canvas>
            </div>

            <table class="table table-sm waves">
              <caption>Loading...</caption>
              <thead>
                <tr>
                  <th scope="col">ID</th>
                  <th scope="col">Type</th>
                  <th scope="col">Start Date</th>
                  <th scope="col">End Date</th>
                  <th scope="col">Days</th>
                  <th scope="col">
                    Peak
                    <span class="sub-th">Test-Positive Rate</span>
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">
                    Cases
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">
                    Hospitalizations
                    <span class="sub-th">daily peak</span>
                  </th>
                  <th scope="col">
                    Deaths
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">Graph</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
          </section>
        </div> <!-- div#waves -->

        <!--
          Phases Tab View
        -->
        <div
          id="phases" aria-labelledby="waves-tab"
          class="tab-pane fade" role="tabpanel">
          <section id="oc-covid-phases">
            <h3>COVID-19 Phases &bull; Orange County, CA</h3>

            <div class="chart-block">
              <canvas id="phases-chart"></canvas>
            </div>

            <h4>Legend</h4>
            <table class="table table-sm waves">
              <caption>Loading...</caption>
              <thead>
                <tr>
                  <th scope="col">ID</th>
                  <th scope="col">Trend</th>
                  <th scope="col">Start Date</th>
                  <th scope="col">End Date</th>
                  <th scope="col">Days</th>
                  <th scope="col">
                    Test-Positive Rate
                    <span class="sub-th">Start &#10145; End</span>
                    <span class="sub-th">7-day average</span>
                  </th>
                  <th scope="col">Pop Slope*</th>
                  <th scope="col">Notes</th>
                  <th scope="col">Graph</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>

            <h4>Notes</h4>
            <ul>
              <li>
                *<b>Pop Slope</b> is the slope of the average change in test-positive rate
                during this phase multiplied by the county population (~3M): <code>change pct
                rate / days &times; pop</code>. One way to think about this: imagine
                testing data accurately represented the entire population (it doesn't).
                This would be how many more (or less) people would be infected each day
                of this phase.
              </li>
              <li>
                Data extracted from JSON export:
                <a target="_blank" href="https://github.com/klenwell/covid-19/blob/master/docs/data/json/oc/phases.json">
                  docs/data/json/oc/phases.json
                </a>.
                (File is updated as data becomes available.)
              </li>
              <li>
                Data sourced from
                <a target="_blank" href="https://occovid19.ochealthinfo.com/coronavirus-in-oc">OC Health Care Agency</a>.
              </li>
              <li>
                More info on wave and phase detection here:
                <a target="_blank" href="https://github.com/klenwell/covid-19/pull/69">
                  https://github.com/klenwell/covid-19/pull/69
                </a>.
              </li>
            </ul>
          </section>
        </div> <!-- div#phases -->
      </div>  <!-- div.tab-content -->
    </div> <!-- div.container -->

    <!--
      Javascript
    -->
    <!-- Third-Party (CDN) -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
      integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous">
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/luxon@2.4.0/build/global/luxon.min.js"
      integrity="sha256-DIsAGD2EF8Qq2PCH9yzX/yt9FliJfWf+aGcdgR6tKwo="
      crossorigin="anonymous">
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js"
      integrity="sha512-sW/w8s4RWTdFFSduOTGtk4isV1+190E/GghVffMA9XczdJ2MDzSzLEubKAs5h0wzgSJOQTRYyaz73L3d6RtJSg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer">
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/1.4.0/chartjs-plugin-annotation.min.js"
      integrity="sha512-HrwQrg8S/xLPE6Qwe7XOghA/FOxX+tuVF4TxbvS73/zKJSs/b1gVl/P4MsdfTFWYFYg/ISVNYIINcg35Xvr6QQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer">
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js">
    </script>

    <!-- Models -->
    <script src="js/oc-metrics-model.js"></script>
    <script src="js/oc-trends-model.js"></script>
    <script src="js/oc-waves-model.js"></script>
    <script src="js/oc-phases-model.js"></script>

    <!-- Components -->
    <script src="js/oc-metrics-table.js"></script>
    <script src="js/oc-trends-table.js"></script>
    <script src="js/oc-waves-table.js"></script>
    <script src="js/oc-waves-chart.js"></script>
    <script src="js/oc-phases-table.js"></script>
    <script src="js/oc-phases-chart.js"></script>
  </body>
</html>
